/* ================================
   Game Map Style (Leaflet + Dark UI)
   -------------------------------
   - 기본 색상 변수
   - 전체 레이아웃
   - 헤더 / 검색창
   - Leaflet 팝업 / 범례 / 가이드라인
   ================================ */

:root {
  --bg: #738E95;        /* 배경색 */
  --fg: #e7eaf0;        /* 글자색 */
  --muted: #a8b0bd;     /* 보조 텍스트 색 */
  --fgpop: #18191A;     /* 팝업 글자색 */
  --mutedpop: #54585E;  /* 팝업 보조 텍스트 색 */
  --panel: #121722;     /* 입력창 / 패널 배경색 */
}

/* Leaflet 기본 배경(#ddd)을 덮어쓰기 */
.leaflet-container {
  background: var(--bg) !important;  /* 원하는 색 */
}

/* 전체 레이아웃 설정 */
* {
  box-sizing: border-box;
}

/* 전체 레이아웃 기본 */
html, body {
  height: 100%;
  margin: 0;
  background: var(--bg);
  color: var(--fg);
  font: 14px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Noto Sans,
        Apple SD Gothic Neo, 'Malgun Gothic', sans-serif;
}

/* 맵: 화면 전체 */
#map {
  position: fixed;
  inset: 0;
}
.leaflet-container { background: var(--bg) !important; }

/* 좌표 표시 줄 */
.coord-row {
  margin-top: .5rem;
  padding: .35rem .55rem;
  border: 1px solid #222a39;
  border-radius: .6rem;
  background: var(--panel);
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: .9rem;
  color: var(--fg);
}

/* -------------------------------
   떠 있는 UI 패널 (왼쪽 위)
   ------------------------------- */
.ui-panel {
  position: fixed;
  top: 12px;
  left: 12px;
  z-index: 1000;
  background: rgba(10,12,18,0.85);
  border: 1px solid #1f2635;
  border-radius: .8rem;
  padding: .6rem .8rem;
  width: clamp(300px, 20vw, 550px);
  backdrop-filter: blur(2px);
}

.ui-panel .topline {
  display: flex;
  align-items: center;
  gap: .6rem;
}

.ui-panel h1 {
  margin: 0;
  font-size: 1rem;
  color: var(--fg);
}

.ui-panel .subline {
  margin-top: .5rem;
  color: var(--muted);
}

.toggle-bounds { user-select: none; }

/* -------------------------------
   검색창 
   ------------------------------- */
/* 제목 아래 검색 3종 세로 배치 */
.ui-panel .search-col {
  display: flex;
  flex-direction: column;
  gap: .4rem;
  margin-top: .6rem;
}

/* 텍스트 입력 공통 */
#search-name,
#search-note {
  background: var(--panel);
  border: 1px solid #222a39;
  border-radius: .6rem;
  padding: .45rem .6rem;
  color: var(--fg);
  outline: none;
  width: 100%;
}

/* 태그 검색 입력 */
.tag-search { position: relative; }
#search-tags {
  background: var(--panel);
  border: 1px solid #222a39;
  border-radius: .6rem;
  padding: .45rem .6rem;
  color: var(--fg);
  outline: none;
  width: 100%;
}

/* 자동완성 리스트 */
.tag-suggest {
  position: absolute;
  left: 0; right: 0;
  top: calc(100% + 6px);
  margin: 0; padding: .3rem 0;
  list-style: none;
  background: rgba(10,12,18,.95);
  border: 1px solid #1f2635;
  border-radius: .6rem;
  max-height: 36vh;
  overflow: auto;
  display: none;           /* 기본 숨김 */
  z-index: 1100;
}
.tag-suggest li {
  padding: .35rem .6rem;
  cursor: pointer;
  color: var(--fg);
}
.tag-suggest li[aria-selected="true"],
.tag-suggest li:hover {
  background: #1c2436;
}

/* 패널 폭은 기존 설정 유지(필요시 조절) */
.ui-panel { width: clamp(300px, 20vw, 550px); }

/* -------------------------------
   Leaflet 팝업 (마커 클릭 시)
   ------------------------------- */
.leaflet-popup-content {
  font-size: 0.9rem;
}

/* 범위 마커 공통(클래스는 hover 등 효과만) */
.leaflet-interactive.area-shape {
  cursor: pointer;
}
.leaflet-interactive.area-shape:hover {
  filter: brightness(1.1);
  stroke-width: 3;
}

/* 팝업 컨테이너 */
.gm-popup {
  display: flex;
  flex-direction: column;
  gap: .35rem;              /* 요소 간 전체 간격 */
}

/* 제목: 굵고 간격 확보 */
.gm-popup-title {
  font-weight: 700;
  font-size: 1rem;
  line-height: 1.2;
  color: var(--fgpop);
  margin-bottom: .25rem;    /* 제목→노트 간격 */
}

/* 노트: 본문 톤, 가독성 있는 줄간격 */
.gm-popup-note {
  color: var(--mutedpop);
  line-height: 1.45;
  white-space: pre-wrap;    /* 줄바꿈 보존하면 좋을 때 */
}

/* 태그 컨테이너 */
.gm-popup-tags {
  display: flex;
  flex-wrap: wrap;
  gap: .25rem .35rem;
  margin-top: .15rem;       /* 노트→태그 간격 */
}

/* 태그 배지 */
.gm-popup-tags .tag {
  font-size: .75rem;
  padding: .15rem .45rem;
  border-radius: .6rem;
  background: var(--fg);
  border: 1px solid var(--muted);
  color: var(--fgpop);
  line-height: 1.1;
}

/* 이모지 핀의 정확한 센터 정렬 박스 */
.emoji-pin { background: transparent; border: 0; }
.emoji-pin .emoji-box {
  /* 아이콘 박스 크기와 동일해야 함 */
  width: 24px; height: 24px;
  display: flex; align-items: center; justify-content: center;
  line-height: 24px;            /* 폰트의 baseline 영향 최소화 */
  /* 필요시 미세 보정(환경별 폰트 렌더 차이): */
  --emoji-dx: 0px;              /* +x → 오른쪽, -x → 왼쪽 */
  --emoji-dy: 0px;              /* +y → 아래, -y → 위 */
  transform: translate(var(--emoji-dx), var(--emoji-dy));
  filter: drop-shadow(0 1px 2px rgba(0,0,0,.6));
}

/* -------------------------------
   Zoom Level Display
   ------------------------------- */
.zoom-display {
  background: rgba(10, 12, 18, 0.85);
  border: 1px solid #1f2635;
  border-radius: 0.6rem;
  padding: 0.25rem 0.6rem;
  color: var(--muted);
  font-size: 0.8rem;
  margin-bottom: 38px; /* 줌 버튼 위쪽 간격 */
  text-align: right;
}

/* -------------------------------
   통합 패널: 범례 레이아웃 + 선택 기능
   ------------------------------- */
.legend-panel { 
   background: rgba(10,12,18,.85); 
   border: 1px solid #1f2635; 
   border-radius: .8rem; 
   padding: .6rem .8rem; 
   color: var(--muted); 
   width: clamp(300px, 20vw, 550px);
   max-height: 60vh; 
   overflow: auto; 
}

.legend-panel .panel-head { 
   border-bottom:1px solid #232a3a; 
   padding-bottom:.4rem; 
   margin-bottom:.4rem; 
   color:var(--fg); 
}

.legend-panel .panel-group + .panel-group { 
   margin-top:.4rem; 
   padding-top:.4rem; 
   border-top:1px dashed #263047; 
}

.legend-panel ul { 
   list-style:none; 
   margin:.25rem 0 0 1rem; 
   padding:0; 
}

.legend-panel li { 
   padding:.1rem 0; 
}

.legend-panel .chk input { 
   margin-right:.45rem; 
}

/* -------------------------------
   맵 경계선 (디버그용)
   ------------------------------- */
.bounds-rect {
  stroke: #7aa2ff;
  stroke-dasharray: 4 3;
  fill: none;
}


/* 맵 전환 스위처: 오른쪽 중앙 */
.map-switcher {
  position: fixed;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  gap: .4rem;
  z-index: 1100;
  user-select: none;
}
.map-switcher button {
  background: rgba(10,12,18,.9);
  border: 1px solid #1f2635;
  border-radius: .6rem;
  padding: .45rem .6rem;
  min-width: 120px;
  color: var(--fg);
  font-size: .9rem;
  cursor: pointer;
}
.map-switcher button:hover { filter: brightness(1.1); }
.map-switcher button.active {
  outline: 2px solid #7aa2ff;
  outline-offset: 1px;
}
@media (max-width: 768px) {
  .map-switcher { top: auto; bottom: 16px; transform: none; }
  .map-switcher button { min-width: 96px; padding: .4rem .5rem; }
}

